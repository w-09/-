<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ”¶æ”¯åˆ†æå„€è¡¨æ¿ - å¾Œå°è‡ªå‹•æ›´æ–°</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
      body {
          font-family: 'Microsoft JhengHei', Arial, sans-serif;
          margin: 20px;
          background-color: #f5f5f5;
      }
      .container {
          max-width: 1400px;
          margin: 0 auto;
          background: white;
          padding: 20px;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      .auto-sync-indicator {
          position: fixed;
          top: 20px;
          right: 20px;
          background: linear-gradient(135deg, #28a745, #20c997);
          color: white;
          padding: 10px 15px;
          border-radius: 25px;
          font-size: 12px;
          font-weight: bold;
          box-shadow: 0 2px 10px rgba(0,0,0,0.2);
          z-index: 1000;
          animation: pulse 2s infinite;
      }
      @keyframes pulse {
          0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
          70% { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
          100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
      }
      .header {
          background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
          color: white;
          padding: 30px;
          border-radius: 10px;
          text-align: center;
          margin-bottom: 20px;
      }
      .header h1 {
          margin: 0 0 10px 0;
          font-size: 2.5em;
          font-weight: 300;
      }
      .header p {
          margin: 0;
          font-size: 1.2em;
          opacity: 0.9;
      }
      .stats-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          margin: 20px 0;
      }
      .stat-card {
          padding: 25px;
          border-radius: 10px;
          text-align: center;
          box-shadow: 0 5px 15px rgba(0,0,0,0.1);
          color: white;
          position: relative;
          overflow: hidden;
      }
      .stat-card::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
          transition: left 0.5s;
      }
      .stat-card:hover::before {
          left: 100%;
      }
      .stat-card.income {
          background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      }
      .stat-card.expense {
          background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
      }
      .stat-card.balance {
          background: linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%);
      }
      .stat-card.transactions {
          background: linear-gradient(135deg, #17a2b8 0%, #6610f2 100%);
      }
      .stat-card h3 {
          font-size: 2.5em;
          margin: 0 0 10px 0;
          font-weight: 300;
      }
      .stat-card p {
          font-size: 1.1em;
          margin: 0;
          opacity: 0.9;
      }
      .chart-container {
          position: relative;
          height: 400px;
          margin: 30px 0;
          background: white;
          padding: 20px;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      .chart-title {
          text-align: center;
          font-size: 1.3em;
          font-weight: bold;
          color: #2c3e50;
          margin-bottom: 20px;
      }
      .controls {
          background: #f8f9fa;
          padding: 20px;
          border-radius: 10px;
          margin: 20px 0;
          box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      }
      .control-group {
          margin: 15px 0;
          display: flex;
          align-items: center;
          flex-wrap: wrap;
          gap: 15px;
      }
      label {
          font-weight: bold;
          color: #495057;
          min-width: 120px;
      }
      input, select {
          padding: 10px;
          border: 1px solid #ddd;
          border-radius: 5px;
          font-size: 14px;
      }
      input[type="checkbox"] {
          transform: scale(1.2);
          margin: 0 8px 0 0;
      }
      button {
          background: #007bff;
          color: white;
          border: none;
          padding: 12px 20px;
          border-radius: 5px;
          cursor: pointer;
          margin: 5px;
          transition: all 0.3s ease;
          font-weight: 500;
      }
      button:hover {
          background: #0056b3;
          transform: translateY(-2px);
          box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      }
      button.btn-success {
          background: #28a745;
      }
      button.btn-success:hover {
          background: #218838;
      }
      button.btn-warning {
          background: #ffc107;
          color: #212529;
      }
      button.btn-warning:hover {
          background: #e0a800;
      }
      .data-table {
          margin: 20px 0;
          overflow-x: auto;
          background: white;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      .table-header {
          background: #f8f9fa;
          padding: 20px;
          border-bottom: 1px solid #dee2e6;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }
      .table-header h3 {
          margin: 0;
          color: #2c3e50;
      }
      table {
          width: 100%;
          border-collapse: collapse;
      }
      th, td {
          padding: 15px;
          text-align: left;
          border-bottom: 1px solid #dee2e6;
      }
      th {
          background-color: #f8f9fa;
          font-weight: bold;
          color: #495057;
          position: sticky;
          top: 0;
      }
      tr:hover {
          background-color: #f8f9fa;
      }
      .amount {
          font-weight: bold;
          text-align: right;
      }
      .amount.positive {
          color: #28a745;
      }
      .amount.negative {
          color: #dc3545;
      }
      .status-indicator {
          padding: 4px 12px;
          border-radius: 15px;
          font-size: 12px;
          font-weight: bold;
          text-align: center;
      }
      .status-income {
          background: #d4edda;
          color: #155724;
      }
      .status-expense {
          background: #f8d7da;
          color: #721c24;
      }
      .sync-log {
          background: #f8f9fa;
          border-left: 4px solid #007bff;
          padding: 20px;
          margin: 20px 0;
          border-radius: 0 10px 10px 0;
          max-height: 300px;
          overflow-y: auto;
      }
      .sync-log h4 {
          margin-top: 0;
          color: #007bff;
          display: flex;
          align-items: center;
          gap: 10px;
      }
      .log-entry {
          font-size: 13px;
          margin: 8px 0;
          padding: 8px 0;
          border-bottom: 1px solid #e9ecef;
          display: flex;
          align-items: center;
          gap: 8px;
      }
      .log-entry:last-child {
          border-bottom: none;
      }
      .log-success {
          color: #28a745;
      }
      .log-error {
          color: #dc3545;
      }
      .log-info {
          color: #17a2b8;
      }
      .log-warning {
          color: #ffc107;
      }
      .update-timestamp {
          text-align: center;
          font-size: 14px;
          color: #6c757d;
          margin: 15px 0;
          padding: 10px;
          background: #f8f9fa;
          border-radius: 5px;
      }
      .tabs {
          display: flex;
          background: #f8f9fa;
          border-radius: 10px;
          margin: 20px 0;
          overflow: hidden;
      }
      .tab {
          flex: 1;
          padding: 15px 20px;
          text-align: center;
          cursor: pointer;
          border: none;
          background: transparent;
          font-weight: 500;
          transition: all 0.3s ease;
      }
      .tab.active {
          background: #007bff;
          color: white;
      }
      .tab-content {
          display: none;
      }
      .tab-content.active {
          display: block;
      }
      .charts-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
          gap: 30px;
          margin: 30px 0;
      }
      @media (max-width: 768px) {
          .charts-grid {
              grid-template-columns: 1fr;
          }
          .control-group {
              flex-direction: column;
              align-items: flex-start;
          }
          .stats-grid {
              grid-template-columns: 1fr;
          }
      }
      .error-message {
          background: #f8d7da;
          color: #721c24;
          padding: 15px;
          border-radius: 5px;
          margin: 10px 0;
          border: 1px solid #f5c6cb;
      }
      .loading-message {
          background: #d1ecf1;
          color: #0c5460;
          padding: 15px;
          border-radius: 5px;
          margin: 10px 0;
          border: 1px solid #bee5eb;
          text-align: center;
      }
  </style>
</head>
<body>
  <div class="auto-sync-indicator" id="syncIndicator">
      ğŸ”„ è‡ªå‹•åŒæ­¥ä¸­... <span id="nextUpdateIn">30</span>s
  </div>

  <div class="container">
      <div class="header">
          <h1>ğŸ’° æ”¶æ”¯åˆ†æå„€è¡¨æ¿</h1>
          <p>å‰é®äºç£æ™ºæ…§å…¬å®…(ç¬¬ä¸€æœŸ)æ–°å»ºçµ±åŒ…å·¥ç¨‹ - å³æ™‚è²¡å‹™ç›£æ§</p>
      </div>
      
      <div class="update-timestamp">
          ğŸ“Š è³‡æ–™ä¾†æº: Google Sheets | æœ€å¾Œæ›´æ–°: <span id="lastUpdate">è¼‰å…¥ä¸­...</span> | 
          ğŸ“ˆ æ”¶å…¥é …ç›®: <span id="incomeCount">0</span> | ğŸ’¸ æ”¯å‡ºé …ç›®: <span id="expenseCount">0</span>
      </div>

      <div class="stats-grid">
          <div class="stat-card income">
              <h3 id="totalIncome">è¼‰å…¥ä¸­...</h3>
              <p>ğŸ’° ç¸½æ”¶å…¥</p>
          </div>
          <div class="stat-card expense">
              <h3 id="totalExpense">è¼‰å…¥ä¸­...</h3>
              <p>ğŸ’¸ ç¸½æ”¯å‡º</p>
          </div>
          <div class="stat-card balance">
              <h3 id="netBalance">è¼‰å…¥ä¸­...</h3>
              <p>ğŸ’ æ·¨é¤˜é¡</p>
          </div>
          <div class="stat-card transactions">
              <h3 id="totalTransactions">è¼‰å…¥ä¸­...</h3>
              <p>ğŸ“Š ç¸½äº¤æ˜“æ•¸</p>
          </div>
      </div>

      <div class="controls">
          <h3>ğŸ“‹ åœ–è¡¨æ§åˆ¶èˆ‡è¨­å®š</h3>
          <div class="control-group">
              <label>åœ–è¡¨é¡å‹:</label>
              <select id="chartType" onchange="updateCharts()">
                  <option value="bar">æŸ±ç‹€åœ–</option>
                  <option value="line">ç·šåœ–</option>
                  <option value="doughnut">åœ“é¤…åœ–</option>
                  <option value="radar">é›·é”åœ–</option>
              </select>
          </div>
          <div class="control-group">
              <label>é¡¯ç¤ºæ•¸æ“š:</label>
              <input type="checkbox" id="showIncome" checked onchange="updateCharts()"> æ”¶å…¥
              <input type="checkbox" id="showExpense" checked onchange="updateCharts()"> æ”¯å‡º
              <input type="checkbox" id="showTrend" onchange="updateCharts()"> è¶¨å‹¢ç·š
          </div>
          <div class="control-group">
              <label>åŒæ­¥è¨­å®š:</label>
              <select id="syncInterval" onchange="updateSyncInterval()">
                  <option value="10000">10ç§’</option>
                  <option value="30000" selected>30ç§’</option>
                  <option value="60000">1åˆ†é˜</option>
                  <option value="300000">5åˆ†é˜</option>
              </select>
          </div>
          <div class="control-group">
              <button onclick="manualSync()" class="btn-success">ğŸ”„ æ‰‹å‹•åŒæ­¥</button>
              <button onclick="exportCharts()" class="btn-warning">ğŸ“Š åŒ¯å‡ºåœ–è¡¨</button>
              <button onclick="exportData()">ğŸ“‹ åŒ¯å‡ºæ•¸æ“š</button>
              <button onclick="toggleAutoSync()" id="toggleSyncBtn">â¸ï¸ æš«åœåŒæ­¥</button>
          </div>
      </div>

      <div class="tabs">
          <button class="tab active" onclick="switchTab('overview')">ğŸ“Š ç¸½è¦½</button>
          <button class="tab" onclick="switchTab('income')">ğŸ’° æ”¶å…¥åˆ†æ</button>
          <button class="tab" onclick="switchTab('expense')">ğŸ’¸ æ”¯å‡ºåˆ†æ</button>
          <button class="tab" onclick="switchTab('cashflow')">ğŸ“ˆ ç¾é‡‘æµ</button>
      </div>

      <!-- ç¸½è¦½é é¢ -->
      <div class="tab-content active" id="overview">
          <div class="charts-grid">
              <div class="chart-container">
                  <div class="chart-title">ğŸ“Š æ”¶æ”¯å°æ¯”åˆ†æ</div>
                  <canvas id="overviewChart"></canvas>
              </div>
              <div class="chart-container">
                  <div class="chart-title">ğŸ“ˆ æœˆåº¦æ”¶æ”¯è¶¨å‹¢</div>
                  <canvas id="trendChart"></canvas>
              </div>
          </div>
      </div>

      <!-- æ”¶å…¥åˆ†æé é¢ -->
      <div class="tab-content" id="income">
          <div class="chart-container">
              <div class="chart-title">ğŸ’° æ”¶å…¥ä¾†æºåˆ†å¸ƒ</div>
              <canvas id="incomeChart"></canvas>
          </div>
          
          <div class="data-table">
              <div class="table-header">
                  <h3>ğŸ’° æ”¶å…¥æ˜ç´° <span id="incomeTableCount">(è¼‰å…¥ä¸­...)</span></h3>
                  <button onclick="exportIncomeData()">ğŸ“¤ åŒ¯å‡ºæ”¶å…¥æ•¸æ“š</button>
              </div>
              <table>
                  <thead>
                      <tr>
                          <th>å…¥è³¬æ—¥æœŸ</th>
                          <th>æ”¶å…¥ä¾†æº</th>
                          <th>é‡‘é¡</th>
                          <th>å‚™è¨»</th>
                          <th>ç‹€æ…‹</th>
                      </tr>
                  </thead>
                  <tbody id="incomeTableBody">
                      <tr>
                          <td colspan="5" class="loading-message">æ­£åœ¨è¼‰å…¥æ”¶å…¥æ•¸æ“š...</td>
                      </tr>
                  </tbody>
              </table>
          </div>
      </div>

      <!-- æ”¯å‡ºåˆ†æé é¢ -->
      <div class="tab-content" id="expense">
          <div class="charts-grid">
              <div class="chart-container">
                  <div class="chart-title">ğŸ—ï¸ å» å•†æ”¯å‡ºåˆ†å¸ƒ</div>
                  <canvas id="vendorChart"></canvas>
              </div>
              <div class="chart-container">
                  <div class="chart-title">ğŸ“‹ å·¥ç¨‹é¡åˆ¥åˆ†æ</div>
                  <canvas id="categoryChart"></canvas>
              </div>
          </div>
          
          <div class="data-table">
              <div class="table-header">
                  <h3>ğŸ’¸ æ”¯å‡ºæ˜ç´° <span id="expenseTableCount">(è¼‰å…¥ä¸­...)</span></h3>
                  <button onclick="exportExpenseData()">ğŸ“¤ åŒ¯å‡ºæ”¯å‡ºæ•¸æ“š</button>
              </div>
              <table>
                  <thead>
                      <tr>
                          <th>é …æ¬¡</th>
                          <th>æ‰¿åŒ…å» å•†</th>
                          <th>æ‰¿ä½œé …ç›®</th>
                          <th>ç™¼ç¥¨é‡‘é¡</th>
                          <th>å‚™è¨»</th>
                          <th>ç‹€æ…‹</th>
                      </tr>
                  </thead>
                  <tbody id="expenseTableBody">
                      <tr>
                          <td colspan="6" class="loading-message">æ­£åœ¨è¼‰å…¥æ”¯å‡ºæ•¸æ“š...</td>
                      </tr>
                  </tbody>
              </table>
          </div>
      </div>

      <!-- ç¾é‡‘æµé é¢ -->
      <div class="tab-content" id="cashflow">
          <div class="chart-container">
              <div class="chart-title">ğŸ’¹ ç¾é‡‘æµé‡åˆ†æ</div>
              <canvas id="cashflowChart"></canvas>
          </div>
          
          <div class="data-table">
              <div class="table-header">
                  <h3>ğŸ“Š ç¾é‡‘æµæ˜ç´°</h3>
              </div>
              <table>
                  <thead>
                      <tr>
                          <th>æ—¥æœŸ</th>
                          <th>é¡å‹</th>
                          <th>é …ç›®</th>
                          <th>é‡‘é¡</th>
                          <th>ç´¯è¨ˆé¤˜é¡</th>
                          <th>è®ŠåŒ–</th>
                      </tr>
                  </thead>
                  <tbody id="cashflowTableBody">
                      <tr>
                          <td colspan="6" class="loading-message">æ­£åœ¨è¼‰å…¥ç¾é‡‘æµæ•¸æ“š...</td>
                      </tr>
                  </tbody>
              </table>
          </div>
      </div>

      <div class="sync-log">
          <h4>ğŸ“‹ åŒæ­¥è¨˜éŒ„èˆ‡ç³»çµ±ç‹€æ…‹</h4>
          <div id="syncLogContent">
              <div class="log-entry log-info">ğŸš€ ç³»çµ±å•Ÿå‹•ä¸­...</div>
          </div>
      </div>
  </div>

  <script>
      // ç³»çµ±é…ç½® - ä½¿ç”¨æ‚¨æä¾›çš„Google Sheetsé€£çµ
      const CONFIG = {
          SHEETS_ID: '1r8WIQBv41Fz19onWPXcIekwMY-L-BZ36U1amh8LA_2U',
          INCOME_GID: '892763171', // æ”¶å…¥å·¥ä½œè¡¨GID
          EXPENSE_GID: '0', // æ”¯å‡ºå·¥ä½œè¡¨GID
          SYNC_INTERVAL: 30000, // 30ç§’åŒæ­¥ä¸€æ¬¡
          MAX_LOG_ENTRIES: 30
      };

      // å…¨åŸŸè®Šæ•¸
      let incomeData = [];
      let expenseData = [];
      let previousIncomeData = [];
      let previousExpenseData = [];
      let charts = {};
      let syncInterval = null;
      let countdownInterval = null;
      let nextUpdateCountdown = 30;
      let isAutoSyncEnabled = true;
      let currentTab = 'overview';

      // Google Sheets CSV URLs
      const INCOME_CSV_URL = `https://docs.google.com/spreadsheets/d/${CONFIG.SHEETS_ID}/export?format=csv&gid=${CONFIG.INCOME_GID}`;
      const EXPENSE_CSV_URL = `https://docs.google.com/spreadsheets/d/${CONFIG.SHEETS_ID}/export?format=csv&gid=${CONFIG.EXPENSE_GID}`;

      // åˆå§‹åŒ–ç³»çµ±
      async function initSystem() {
          addLogEntry('ğŸš€ ç³»çµ±åˆå§‹åŒ–ä¸­...', 'info');
          
          try {
              await initCharts();
              
              // å…ˆè¼‰å…¥ç¤ºä¾‹æ•¸æ“š
              loadSampleData();
              updateStats();
              updateCharts();
              updateTables();
              updateLastUpdateTime();
              
              // ç„¶å¾Œå˜—è©¦å¾Google SheetsåŒæ­¥
              await performSync();
              
              startAutoSync();
              startCountdown();
              
              addLogEntry('âœ… ç³»çµ±åˆå§‹åŒ–å®Œæˆï¼Œè‡ªå‹•åŒæ­¥å·²å•Ÿå‹•', 'success');
          } catch (error) {
              addLogEntry('âŒ ç³»çµ±åˆå§‹åŒ–å¤±æ•—: ' + error.message, 'error');
              console.error('åˆå§‹åŒ–éŒ¯èª¤:', error);
          }
      }

      // è¼‰å…¥ç¤ºä¾‹æ•¸æ“š
      function loadSampleData() {
          // æ”¶å…¥ç¤ºä¾‹æ•¸æ“š - æ–°æ ¼å¼ï¼šå…¥è³¬æ—¥æœŸ/æ”¶å…¥ä¾†æº/é‡‘é¡/å‚™è¨»
          incomeData = [
              { å…¥è³¬æ—¥æœŸ: '2024-01-15', æ”¶å…¥ä¾†æº: 'å·¥ç¨‹æ¬¾ç¬¬ä¸€æœŸ', é‡‘é¡: 50000000, å‚™è¨»: 'åˆç´„æ¬¾é …' },
              { å…¥è³¬æ—¥æœŸ: '2024-02-20', æ”¶å…¥ä¾†æº: 'æ”¿åºœè£œåŠ©', é‡‘é¡: 10000000, å‚™è¨»: 'æ™ºæ…§å»ºç¯‰è£œåŠ©' },
              { å…¥è³¬æ—¥æœŸ: '2024-03-10', æ”¶å…¥ä¾†æº: 'å·¥ç¨‹æ¬¾ç¬¬äºŒæœŸ', é‡‘é¡: 30000000, å‚™è¨»: 'é€²åº¦æ¬¾' },
              { å…¥è³¬æ—¥æœŸ: '2024-04-05', æ”¶å…¥ä¾†æº: 'è¿½åŠ é ç®—', é‡‘é¡: 15000000, å‚™è¨»: 'è®Šæ›´è¨­è¨ˆ' },
              { å…¥è³¬æ—¥æœŸ: '2024-05-12', æ”¶å…¥ä¾†æº: 'å·¥ç¨‹æ¬¾ç¬¬ä¸‰æœŸ', é‡‘é¡: 25000000, å‚™è¨»: 'éšæ®µå®Œå·¥æ¬¾' }
          ];

          // æ”¯å‡ºç¤ºä¾‹æ•¸æ“š
          expenseData = [
              { é …æ¬¡: '001', æ‰¿åŒ…å» å•†: 'å¤§æˆå»ºè¨­', æ‰¿ä½œé …ç›®: 'åŸºç¤å·¥ç¨‹', æœ¬æ¬¡ç™¼ç¥¨é‡‘é¡: 15000000, å‚™è¨»: 'åœ°åŸºé–‹æŒ–' },
              { é …æ¬¡: '002', æ‰¿åŒ…å» å•†: 'ä¸­è¯å·¥ç¨‹', æ‰¿ä½œé …ç›®: 'çµæ§‹å·¥ç¨‹', æœ¬æ¬¡ç™¼ç¥¨é‡‘é¡: 25000000, å‚™è¨»: 'é‹¼ç­‹æ··å‡åœŸ' },
              { é …æ¬¡: '003', æ‰¿åŒ…å» å•†: 'å°ç£é›»åŠ›', æ‰¿ä½œé …ç›®: 'é›»æ°£å·¥ç¨‹', æœ¬æ¬¡ç™¼ç¥¨é‡‘é¡: 8000000, å‚™è¨»: 'é…é›»ç³»çµ±' },
              { é …æ¬¡: '004', æ‰¿åŒ…å» å•†: 'æ™ºæ…§ç§‘æŠ€', æ‰¿ä½œé …ç›®: 'æ™ºèƒ½ç³»çµ±', æœ¬æ¬¡ç™¼ç¥¨é‡‘é¡: 12000000, å‚™è¨»: 'IoTè¨­å‚™å®‰è£' },
              { é …æ¬¡: '005', æ‰¿åŒ…å» å•†: 'ç’°ä¿å·¥ç¨‹', æ‰¿ä½œé …ç›®: 'ç¶ å»ºç¯‰è¨­æ–½', æœ¬æ¬¡ç™¼ç¥¨é‡‘é¡: 6000000, å‚™è¨»: 'å¤ªé™½èƒ½æ¿' },
              { é …æ¬¡: '006', æ‰¿åŒ…å» å•†: 'è£ä¿®å…¬å¸', æ‰¿ä½œé …ç›®: 'å®¤å…§è£ä¿®', æœ¬æ¬¡ç™¼ç¥¨é‡‘é¡: 18000000, å‚™è¨»: 'ç²¾è£ä¿®å·¥ç¨‹' }
          ];

          addLogEntry('ğŸ“‹ å·²è¼‰å…¥ç¤ºä¾‹æ•¸æ“šé€²è¡Œå±•ç¤º', 'info');
      }

      // åˆå§‹åŒ–åœ–è¡¨
      async function initCharts() {
          // ç¸½è¦½åœ–è¡¨
          charts.overview = new Chart(document.getElementById('overviewChart').getContext('2d'), {
              type: 'bar',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: true, position: 'top' }
                  },
                  scales: {
                      y: {
                          beginAtZero: true,
                          ticks: {
                              callback: function(value) {
                                  return 'NT$ ' + (value / 1000000).toFixed(1) + 'M';
                              }
                          }
                      }
                  },
                  animation: { duration: 1000, easing: 'easeInOutQuart' }
              }
          });

          // è¶¨å‹¢åœ–è¡¨
          charts.trend = new Chart(document.getElementById('trendChart').getContext('2d'), {
              type: 'line',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: true, position: 'top' }
                  },
                  scales: {
                      y: {
                          beginAtZero: true,
                          ticks: {
                              callback: function(value) {
                                  return 'NT$ ' + (value / 1000000).toFixed(1) + 'M';
                              }
                          }
                      }
                  },
                  animation: { duration: 1000, easing: 'easeInOutQuart' }
              }
          });

          // æ”¶å…¥åœ–è¡¨
          charts.income = new Chart(document.getElementById('incomeChart').getContext('2d'), {
              type: 'doughnut',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: true, position: 'bottom' },
                      tooltip: {
                          callbacks: {
                              label: function(context) {
                                  const value = context.parsed;
                                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                  const percentage = ((value / total) * 100).toFixed(1);
                                  return context.label + ': NT$ ' + value.toLocaleString() + ' (' + percentage + '%)';
                              }
                          }
                      }
                  },
                  animation: { duration: 1000, easing: 'easeInOutQuart' }
              }
          });

          // å» å•†æ”¯å‡ºåœ–è¡¨
          charts.vendor = new Chart(document.getElementById('vendorChart').getContext('2d'), {
              type: 'doughnut',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: true, position: 'bottom' },
                      tooltip: {
                          callbacks: {
                              label: function(context) {
                                  const value = context.parsed;
                                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                  const percentage = ((value / total) * 100).toFixed(1);
                                  return context.label + ': NT$ ' + value.toLocaleString() + ' (' + percentage + '%)';
                              }
                          }
                      }
                  },
                  animation: { duration: 1000, easing: 'easeInOutQuart' }
              }
          });

          // å·¥ç¨‹é¡åˆ¥åœ–è¡¨
          charts.category = new Chart(document.getElementById('categoryChart').getContext('2d'), {
              type: 'bar',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: false }
                  },
                  scales: {
                      y: {
                          beginAtZero: true,
                          ticks: {
                              callback: function(value) {
                                  
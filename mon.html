<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Êî∂ÊîØÂàÜÊûêÂÑÄË°®Êùø - ÂæåÂè∞Ëá™ÂãïÊõ¥Êñ∞</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
      body {
          font-family: 'Microsoft JhengHei', Arial, sans-serif;
          margin: 20px;
          background-color: #f5f5f5;
      }
      .container {
          max-width: 1400px;
          margin: 0 auto;
          background: white;
          padding: 20px;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      .auto-sync-indicator {
          position: fixed;
          top: 20px;
          right: 20px;
          background: linear-gradient(135deg, #28a745, #20c997);
          color: white;
          padding: 10px 15px;
          border-radius: 25px;
          font-size: 12px;
          font-weight: bold;
          box-shadow: 0 2px 10px rgba(0,0,0,0.2);
          z-index: 1000;
          animation: pulse 2s infinite;
      }
      @keyframes pulse {
          0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
          70% { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
          100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
      }
      .header {
          background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
          color: white;
          padding: 30px;
          border-radius: 10px;
          text-align: center;
          margin-bottom: 20px;
      }
      .header h1 {
          margin: 0 0 10px 0;
          font-size: 2.5em;
          font-weight: 300;
      }
      .header p {
          margin: 0;
          font-size: 1.2em;
          opacity: 0.9;
      }
      .stats-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          margin: 20px 0;
      }
      .stat-card {
          padding: 25px;
          border-radius: 10px;
          text-align: center;
          box-shadow: 0 5px 15px rgba(0,0,0,0.1);
          color: white;
          position: relative;
          overflow: hidden;
      }
      .stat-card::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
          transition: left 0.5s;
      }
      .stat-card:hover::before {
          left: 100%;
      }
      .stat-card.income {
          background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      }
      .stat-card.expense {
          background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
      }
      .stat-card.balance {
          background: linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%);
      }
      .stat-card.transactions {
          background: linear-gradient(135deg, #17a2b8 0%, #6610f2 100%);
      }
      .stat-card h3 {
          font-size: 2.5em;
          margin: 0 0 10px 0;
          font-weight: 300;
      }
      .stat-card p {
          font-size: 1.1em;
          margin: 0;
          opacity: 0.9;
      }
      .chart-container {
          position: relative;
          height: 400px;
          margin: 30px 0;
          background: white;
          padding: 20px;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      .chart-title {
          text-align: center;
          font-size: 1.3em;
          font-weight: bold;
          color: #2c3e50;
          margin-bottom: 20px;
      }
      .controls {
          background: #f8f9fa;
          padding: 20px;
          border-radius: 10px;
          margin: 20px 0;
          box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      }
      .control-group {
          margin: 15px 0;
          display: flex;
          align-items: center;
          flex-wrap: wrap;
          gap: 15px;
      }
      label {
          font-weight: bold;
          color: #495057;
          min-width: 120px;
      }
      input, select {
          padding: 10px;
          border: 1px solid #ddd;
          border-radius: 5px;
          font-size: 14px;
      }
      input[type="checkbox"] {
          transform: scale(1.2);
          margin: 0 8px 0 0;
      }
      button {
          background: #007bff;
          color: white;
          border: none;
          padding: 12px 20px;
          border-radius: 5px;
          cursor: pointer;
          margin: 5px;
          transition: all 0.3s ease;
          font-weight: 500;
      }
      button:hover {
          background: #0056b3;
          transform: translateY(-2px);
          box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      }
      button.btn-success {
          background: #28a745;
      }
      button.btn-success:hover {
          background: #218838;
      }
      button.btn-warning {
          background: #ffc107;
          color: #212529;
      }
      button.btn-warning:hover {
          background: #e0a800;
      }
      .data-table {
          margin: 20px 0;
          overflow-x: auto;
          background: white;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      .table-header {
          background: #f8f9fa;
          padding: 20px;
          border-bottom: 1px solid #dee2e6;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }
      .table-header h3 {
          margin: 0;
          color: #2c3e50;
      }
      table {
          width: 100%;
          border-collapse: collapse;
      }
      th, td {
          padding: 15px;
          text-align: left;
          border-bottom: 1px solid #dee2e6;
      }
      th {
          background-color: #f8f9fa;
          font-weight: bold;
          color: #495057;
          position: sticky;
          top: 0;
      }
      tr:hover {
          background-color: #f8f9fa;
      }
      .amount {
          font-weight: bold;
          text-align: right;
      }
      .amount.positive {
          color: #28a745;
      }
      .amount.negative {
          color: #dc3545;
      }
      .status-indicator {
          padding: 4px 12px;
          border-radius: 15px;
          font-size: 12px;
          font-weight: bold;
          text-align: center;
      }
      .status-income {
          background: #d4edda;
          color: #155724;
      }
      .status-expense {
          background: #f8d7da;
          color: #721c24;
      }
      .sync-log {
          background: #f8f9fa;
          border-left: 4px solid #007bff;
          padding: 20px;
          margin: 20px 0;
          border-radius: 0 10px 10px 0;
          max-height: 300px;
          overflow-y: auto;
      }
      .sync-log h4 {
          margin-top: 0;
          color: #007bff;
          display: flex;
          align-items: center;
          gap: 10px;
      }
      .log-entry {
          font-size: 13px;
          margin: 8px 0;
          padding: 8px 0;
          border-bottom: 1px solid #e9ecef;
          display: flex;
          align-items: center;
          gap: 8px;
      }
      .log-entry:last-child {
          border-bottom: none;
      }
      .log-success {
          color: #28a745;
      }
      .log-error {
          color: #dc3545;
      }
      .log-info {
          color: #17a2b8;
      }
      .log-warning {
          color: #ffc107;
      }
      .update-timestamp {
          text-align: center;
          font-size: 14px;
          color: #6c757d;
          margin: 15px 0;
          padding: 10px;
          background: #f8f9fa;
          border-radius: 5px;
      }
      .tabs {
          display: flex;
          background: #f8f9fa;
          border-radius: 10px;
          margin: 20px 0;
          overflow: hidden;
      }
      .tab {
          flex: 1;
          padding: 15px 20px;
          text-align: center;
          cursor: pointer;
          border: none;
          background: transparent;
          font-weight: 500;
          transition: all 0.3s ease;
      }
      .tab.active {
          background: #007bff;
          color: white;
      }
      .tab-content {
          display: none;
      }
      .tab-content.active {
          display: block;
      }
      .charts-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
          gap: 30px;
          margin: 30px 0;
      }
      @media (max-width: 768px) {
          .charts-grid {
              grid-template-columns: 1fr;
          }
          .control-group {
              flex-direction: column;
              align-items: flex-start;
          }
          .stats-grid {
              grid-template-columns: 1fr;
          }
      }
      .error-message {
          background: #f8d7da;
          color: #721c24;
          padding: 15px;
          border-radius: 5px;
          margin: 10px 0;
          border: 1px solid #f5c6cb;
      }
      .loading-message {
          background: #d1ecf1;
          color: #0c5460;
          padding: 15px;
          border-radius: 5px;
          margin: 10px 0;
          border: 1px solid #bee5eb;
          text-align: center;
      }
  </style>
</head>
<body>
  <div class="auto-sync-indicator" id="syncIndicator">
      üîÑ Ëá™ÂãïÂêåÊ≠•‰∏≠... <span id="nextUpdateIn">30</span>s
  </div>

  <div class="container">
      <div class="header">
          <h1>üí∞ Êî∂ÊîØÂàÜÊûêÂÑÄË°®Êùø</h1>
          <p>ÂâçÈéÆ‰∫ûÁÅ£Êô∫ÊÖßÂÖ¨ÂÆÖ(Á¨¨‰∏ÄÊúü)Êñ∞Âª∫Áµ±ÂåÖÂ∑•Á®ã - Âç≥ÊôÇË≤°ÂãôÁõ£Êéß</p>
      </div>
      
      <div class="update-timestamp">
          üìä Ë≥áÊñô‰æÜÊ∫ê: Google Sheets | ÊúÄÂæåÊõ¥Êñ∞: <span id="lastUpdate">ËºâÂÖ•‰∏≠...</span> | 
          üìà Êî∂ÂÖ•È†ÖÁõÆ: <span id="incomeCount">0</span> | üí∏ ÊîØÂá∫È†ÖÁõÆ: <span id="expenseCount">0</span>
      </div>

      <div class="stats-grid">
          <div class="stat-card income">
              <h3 id="totalIncome">ËºâÂÖ•‰∏≠...</h3>
              <p>üí∞ Á∏ΩÊî∂ÂÖ•</p>
          </div>
          <div class="stat-card expense">
              <h3 id="totalExpense">ËºâÂÖ•‰∏≠...</h3>
              <p>üí∏ Á∏ΩÊîØÂá∫</p>
          </div>
          <div class="stat-card balance">
              <h3 id="netBalance">ËºâÂÖ•‰∏≠...</h3>
              <p>üíé Ê∑®È§òÈ°ç</p>
          </div>
          <div class="stat-card transactions">
              <h3 id="totalTransactions">ËºâÂÖ•‰∏≠...</h3>
              <p>üìä Á∏Ω‰∫§ÊòìÊï∏</p>
          </div>
      </div>

      <div class="controls">
          <h3>üìã ÂúñË°®ÊéßÂà∂ËàáË®≠ÂÆö</h3>
          <div class="control-group">
              <label>ÂúñË°®È°ûÂûã:</label>
              <select id="chartType" onchange="updateCharts()">
                  <option value="bar">Êü±ÁãÄÂúñ</option>
                  <option value="line">Á∑öÂúñ</option>
                  <option value="doughnut">ÂúìÈ§ÖÂúñ</option>
                  <option value="radar">Èõ∑ÈÅîÂúñ</option>
              </select>
          </div>
          <div class="control-group">
              <label>È°ØÁ§∫Êï∏Êìö:</label>
              <input type="checkbox" id="showIncome" checked onchange="updateCharts()"> Êî∂ÂÖ•
              <input type="checkbox" id="showExpense" checked onchange="updateCharts()"> ÊîØÂá∫
              <input type="checkbox" id="showTrend" onchange="updateCharts()"> Ë∂®Âã¢Á∑ö
          </div>
          <div class="control-group">
              <label>ÂêåÊ≠•Ë®≠ÂÆö:</label>
              <select id="syncInterval" onchange="updateSyncInterval()">
                  <option value="10000">10Áßí</option>
                  <option value="30000" selected>30Áßí</option>
                  <option value="60000">1ÂàÜÈêò</option>
                  <option value="300000">5ÂàÜÈêò</option>
              </select>
          </div>
          <div class="control-group">
              <button onclick="manualSync()" class="btn-success">üîÑ ÊâãÂãïÂêåÊ≠•</button>
              <button onclick="exportCharts()" class="btn-warning">üìä ÂåØÂá∫ÂúñË°®</button>
              <button onclick="exportData()">üìã ÂåØÂá∫Êï∏Êìö</button>
              <button onclick="toggleAutoSync()" id="toggleSyncBtn">‚è∏Ô∏è Êö´ÂÅúÂêåÊ≠•</button>
          </div>
      </div>

      <div class="tabs">
          <button class="tab active" onclick="switchTab('overview')">üìä Á∏ΩË¶Ω</button>
          <button class="tab" onclick="switchTab('income')">üí∞ Êî∂ÂÖ•ÂàÜÊûê</button>
          <button class="tab" onclick="switchTab('expense')">üí∏ ÊîØÂá∫ÂàÜÊûê</button>
          <button class="tab" onclick="switchTab('cashflow')">üìà ÁèæÈáëÊµÅ</button>
      </div>

      <!-- Á∏ΩË¶ΩÈ†ÅÈù¢ -->
      <div class="tab-content active" id="overview">
          <div class="charts-grid">
              <div class="chart-container">
                  <div class="chart-title">üìä Êî∂ÊîØÂ∞çÊØîÂàÜÊûê</div>
                  <canvas id="overviewChart"></canvas>
              </div>
              <div class="chart-container">
                  <div class="chart-title">üìà ÊúàÂ∫¶Êî∂ÊîØË∂®Âã¢</div>
                  <canvas id="trendChart"></canvas>
              </div>
          </div>
      </div>

      <!-- Êî∂ÂÖ•ÂàÜÊûêÈ†ÅÈù¢ -->
      <div class="tab-content" id="income">
          <div class="chart-container">
              <div class="chart-title">üí∞ Êî∂ÂÖ•‰æÜÊ∫êÂàÜÂ∏É</div>
              <canvas id="incomeChart"></canvas>
          </div>
          
          <div class="data-table">
              <div class="table-header">
                  <h3>üí∞ Êî∂ÂÖ•ÊòéÁ¥∞ <span id="incomeTableCount">(ËºâÂÖ•‰∏≠...)</span></h3>
                  <button onclick="exportIncomeData()">üì§ ÂåØÂá∫Êî∂ÂÖ•Êï∏Êìö</button>
              </div>
              <table>
                  <thead>
                      <tr>
                          <th>ÂÖ•Ë≥¨Êó•Êúü</th>
                          <th>Êî∂ÂÖ•‰æÜÊ∫ê</th>
                          <th>ÈáëÈ°ç</th>
                          <th>ÂÇôË®ª</th>
                          <th>ÁãÄÊÖã</th>
                      </tr>
                  </thead>
                  <tbody id="incomeTableBody">
                      <tr>
                          <td colspan="5" class="loading-message">Ê≠£Âú®ËºâÂÖ•Êî∂ÂÖ•Êï∏Êìö...</td>
                      </tr>
                  </tbody>
              </table>
          </div>
      </div>

      <!-- ÊîØÂá∫ÂàÜÊûêÈ†ÅÈù¢ -->
      <div class="tab-content" id="expense">
          <div class="charts-grid">
              <div class="chart-container">
                  <div class="chart-title">üèóÔ∏è Âª†ÂïÜÊîØÂá∫ÂàÜÂ∏É</div>
                  <canvas id="vendorChart"></canvas>
              </div>
              <div class="chart-container">
                  <div class="chart-title">üìã Â∑•Á®ãÈ°ûÂà•ÂàÜÊûê</div>
                  <canvas id="categoryChart"></canvas>
              </div>
          </div>
          
          <div class="data-table">
              <div class="table-header">
                  <h3>üí∏ ÊîØÂá∫ÊòéÁ¥∞ <span id="expenseTableCount">(ËºâÂÖ•‰∏≠...)</span></h3>
                  <button onclick="exportExpenseData()">üì§ ÂåØÂá∫ÊîØÂá∫Êï∏Êìö</button>
              </div>
              <table>
                  <thead>
                      <tr>
                          <th>È†ÖÊ¨°</th>
                          <th>ÊâøÂåÖÂª†ÂïÜ</th>
                          <th>Êâø‰ΩúÈ†ÖÁõÆ</th>
                          <th>ÁôºÁ•®ÈáëÈ°ç</th>
                          <th>ÂÇôË®ª</th>
                          <th>ÁãÄÊÖã</th>
                      </tr>
                  </thead>
                  <tbody id="expenseTableBody">
                      <tr>
                          <td colspan="6" class="loading-message">Ê≠£Âú®ËºâÂÖ•ÊîØÂá∫Êï∏Êìö...</td>
                      </tr>
                  </tbody>
              </table>
          </div>
      </div>

      <!-- ÁèæÈáëÊµÅÈ†ÅÈù¢ -->
      <div class="tab-content" id="cashflow">
          <div class="chart-container">
              <div class="chart-title">üíπ ÁèæÈáëÊµÅÈáèÂàÜÊûê</div>
              <canvas id="cashflowChart"></canvas>
          </div>
          
          <div class="data-table">
              <div class="table-header">
                  <h3>üìä ÁèæÈáëÊµÅÊòéÁ¥∞</h3>
              </div>
              <table>
                  <thead>
                      <tr>
                          <th>Êó•Êúü</th>
                          <th>È°ûÂûã</th>
                          <th>È†ÖÁõÆ</th>
                          <th>ÈáëÈ°ç</th>
                          <th>Á¥ØË®àÈ§òÈ°ç</th>
                          <th>ËÆäÂåñ</th>
                      </tr>
                  </thead>
                  <tbody id="cashflowTableBody">
                      <tr>
                          <td colspan="6" class="loading-message">Ê≠£Âú®ËºâÂÖ•ÁèæÈáëÊµÅÊï∏Êìö...</td>
                      </tr>
                  </tbody>
              </table>
          </div>
      </div>

      <div class="sync-log">
          <h4>üìã ÂêåÊ≠•Ë®òÈåÑËàáÁ≥ªÁµ±ÁãÄÊÖã</h4>
          <div id="syncLogContent">
              <div class="log-entry log-info">üöÄ Á≥ªÁµ±ÂïüÂãï‰∏≠...</div>
          </div>
      </div>
  </div>

  <script>
      // Á≥ªÁµ±ÈÖçÁΩÆ - ‰ΩøÁî®ÊÇ®Êèê‰æõÁöÑGoogle SheetsÈÄ£Áµê
      const CONFIG = {
          SHEETS_ID: '1r8WIQBv41Fz19onWPXcIekwMY-L-BZ36U1amh8LA_2U',
          INCOME_GID: '892763171', // Êî∂ÂÖ•Â∑•‰ΩúË°®GID
          EXPENSE_GID: '0', // ÊîØÂá∫Â∑•‰ΩúË°®GID
          SYNC_INTERVAL: 30000, // 30ÁßíÂêåÊ≠•‰∏ÄÊ¨°
          MAX_LOG_ENTRIES: 30
      };

      // ÂÖ®ÂüüËÆäÊï∏
      let incomeData = [];
      let expenseData = [];
      let previousIncomeData = [];
      let previousExpenseData = [];
      let charts = {};
      let syncInterval = null;
      let countdownInterval = null;
      let nextUpdateCountdown = 30;
      let isAutoSyncEnabled = true;
      let currentTab = 'overview';

      // Google Sheets CSV URLs
      const INCOME_CSV_URL = `https://docs.google.com/spreadsheets/d/${CONFIG.SHEETS_ID}/export?format=csv&gid=${CONFIG.INCOME_GID}`;
      const EXPENSE_CSV_URL = `https://docs.google.com/spreadsheets/d/${CONFIG.SHEETS_ID}/export?format=csv&gid=${CONFIG.EXPENSE_GID}`;

      // ÂàùÂßãÂåñÁ≥ªÁµ±
      async function initSystem() {
          addLogEntry('üöÄ Á≥ªÁµ±ÂàùÂßãÂåñ‰∏≠...', 'info');
          
          try {
              await initCharts();
              
              // ÂÖàËºâÂÖ•Á§∫‰æãÊï∏Êìö
              loadSampleData();
              updateStats();
              updateCharts();
              updateTables();
              updateLastUpdateTime();
              
              // ÁÑ∂ÂæåÂòóË©¶ÂæûGoogle SheetsÂêåÊ≠•
              await performSync();
              
              startAutoSync();
              startCountdown();
              
              addLogEntry('‚úÖ Á≥ªÁµ±ÂàùÂßãÂåñÂÆåÊàêÔºåËá™ÂãïÂêåÊ≠•Â∑≤ÂïüÂãï', 'success');
          } catch (error) {
              addLogEntry('‚ùå Á≥ªÁµ±ÂàùÂßãÂåñÂ§±Êïó: ' + error.message, 'error');
              console.error('ÂàùÂßãÂåñÈåØË™§:', error);
          }
      }

      // ËºâÂÖ•Á§∫‰æãÊï∏Êìö
      function loadSampleData() {
          // Êî∂ÂÖ•Á§∫‰æãÊï∏Êìö - Êñ∞Ê†ºÂºèÔºöÂÖ•Ë≥¨Êó•Êúü/Êî∂ÂÖ•‰æÜÊ∫ê/ÈáëÈ°ç/ÂÇôË®ª
          incomeData = [
              { ÂÖ•Ë≥¨Êó•Êúü: '2024-01-15', Êî∂ÂÖ•‰æÜÊ∫ê: 'Â∑•Á®ãÊ¨æÁ¨¨‰∏ÄÊúü', ÈáëÈ°ç: 50000000, ÂÇôË®ª: 'ÂêàÁ¥ÑÊ¨æÈ†Ö' },
              { ÂÖ•Ë≥¨Êó•Êúü: '2024-02-20', Êî∂ÂÖ•‰æÜÊ∫ê: 'ÊîøÂ∫úË£úÂä©', ÈáëÈ°ç: 10000000, ÂÇôË®ª: 'Êô∫ÊÖßÂª∫ÁØâË£úÂä©' },
              { ÂÖ•Ë≥¨Êó•Êúü: '2024-03-10', Êî∂ÂÖ•‰æÜÊ∫ê: 'Â∑•Á®ãÊ¨æÁ¨¨‰∫åÊúü', ÈáëÈ°ç: 30000000, ÂÇôË®ª: 'ÈÄ≤Â∫¶Ê¨æ' },
              { ÂÖ•Ë≥¨Êó•Êúü: '2024-04-05', Êî∂ÂÖ•‰æÜÊ∫ê: 'ËøΩÂä†È†êÁÆó', ÈáëÈ°ç: 15000000, ÂÇôË®ª: 'ËÆäÊõ¥Ë®≠Ë®à' },
              { ÂÖ•Ë≥¨Êó•Êúü: '2024-05-12', Êî∂ÂÖ•‰æÜÊ∫ê: 'Â∑•Á®ãÊ¨æÁ¨¨‰∏âÊúü', ÈáëÈ°ç: 25000000, ÂÇôË®ª: 'ÈöéÊÆµÂÆåÂ∑•Ê¨æ' }
          ];

          // ÊîØÂá∫Á§∫‰æãÊï∏Êìö
          expenseData = [
              { È†ÖÊ¨°: '001', ÊâøÂåÖÂª†ÂïÜ: 'Â§ßÊàêÂª∫Ë®≠', Êâø‰ΩúÈ†ÖÁõÆ: 'Âü∫Á§éÂ∑•Á®ã', Êú¨Ê¨°ÁôºÁ•®ÈáëÈ°ç: 15000000, ÂÇôË®ª: 'Âú∞Âü∫ÈñãÊåñ' },
              { È†ÖÊ¨°: '002', ÊâøÂåÖÂª†ÂïÜ: '‰∏≠ËèØÂ∑•Á®ã', Êâø‰ΩúÈ†ÖÁõÆ: 'ÁµêÊßãÂ∑•Á®ã', Êú¨Ê¨°ÁôºÁ•®ÈáëÈ°ç: 25000000, ÂÇôË®ª: 'ÈãºÁ≠ãÊ∑∑ÂáùÂúü' },
              { È†ÖÊ¨°: '003', ÊâøÂåÖÂª†ÂïÜ: 'Âè∞ÁÅ£ÈõªÂäõ', Êâø‰ΩúÈ†ÖÁõÆ: 'ÈõªÊ∞£Â∑•Á®ã', Êú¨Ê¨°ÁôºÁ•®ÈáëÈ°ç: 8000000, ÂÇôË®ª: 'ÈÖçÈõªÁ≥ªÁµ±' },
              { È†ÖÊ¨°: '004', ÊâøÂåÖÂª†ÂïÜ: 'Êô∫ÊÖßÁßëÊäÄ', Êâø‰ΩúÈ†ÖÁõÆ: 'Êô∫ËÉΩÁ≥ªÁµ±', Êú¨Ê¨°ÁôºÁ•®ÈáëÈ°ç: 12000000, ÂÇôË®ª: 'IoTË®≠ÂÇôÂÆâË£ù' },
              { È†ÖÊ¨°: '005', ÊâøÂåÖÂª†ÂïÜ: 'Áí∞‰øùÂ∑•Á®ã', Êâø‰ΩúÈ†ÖÁõÆ: 'Á∂†Âª∫ÁØâË®≠ÊñΩ', Êú¨Ê¨°ÁôºÁ•®ÈáëÈ°ç: 6000000, ÂÇôË®ª: 'Â§™ÈôΩËÉΩÊùø' },
              { È†ÖÊ¨°: '006', ÊâøÂåÖÂª†ÂïÜ: 'Ë£ù‰øÆÂÖ¨Âè∏', Êâø‰ΩúÈ†ÖÁõÆ: 'ÂÆ§ÂÖßË£ù‰øÆ', Êú¨Ê¨°ÁôºÁ•®ÈáëÈ°ç: 18000000, ÂÇôË®ª: 'Á≤æË£ù‰øÆÂ∑•Á®ã' }
          ];

          addLogEntry('üìã Â∑≤ËºâÂÖ•Á§∫‰æãÊï∏ÊìöÈÄ≤Ë°åÂ±ïÁ§∫', 'info');
      }

      // ÂàùÂßãÂåñÂúñË°®
      async function initCharts() {
          // Á∏ΩË¶ΩÂúñË°®
          charts.overview = new Chart(document.getElementById('overviewChart').getContext('2d'), {
              type: 'bar',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: true, position: 'top' }
                  },
                  scales: {
                      y: {
                          beginAtZero: true,
                          ticks: {
                              callback: function(value) {
                                  return 'NT$ ' + (value / 1000000).toFixed(1) + 'M';
                              }
                          }
                      }
                  },
                  animation: { duration: 1000, easing: 'easeInOutQuart' }
              }
          });

          // Ë∂®Âã¢ÂúñË°®
          charts.trend = new Chart(document.getElementById('trendChart').getContext('2d'), {
              type: 'line',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: true, position: 'top' }
                  },
                  scales: {
                      y: {
                          beginAtZero: true,
                          ticks: {
                              callback: function(value) {
                                  return 'NT$ ' + (value / 1000000).toFixed(1) + 'M';
                              }
                          }
                      }
                  },
                  animation: { duration: 1000, easing: 'easeInOutQuart' }
              }
          });

          // Êî∂ÂÖ•ÂúñË°®
          charts.income = new Chart(document.getElementById('incomeChart').getContext('2d'), {
              type: 'doughnut',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: true, position: 'bottom' },
                      tooltip: {
                          callbacks: {
                              label: function(context) {
                                  const value = context.parsed;
                                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                  const percentage = ((value / total) * 100).toFixed(1);
                                  return context.label + ': NT$ ' + value.toLocaleString() + ' (' + percentage + '%)';
                              }
                          }
                      }
                  },
                  animation: { duration: 1000, easing: 'easeInOutQuart' }
              }
          });

          // Âª†ÂïÜÊîØÂá∫ÂúñË°®
          charts.vendor = new Chart(document.getElementById('vendorChart').getContext('2d'), {
              type: 'doughnut',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: true, position: 'bottom' },
                      tooltip: {
                          callbacks: {
                              label: function(context) {
                                  const value = context.parsed;
                                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                  const percentage = ((value / total) * 100).toFixed(1);
                                  return context.label + ': NT$ ' + value.toLocaleString() + ' (' + percentage + '%)';
                              }
                          }
                      }
                  },
                  animation: { duration: 1000, easing: 'easeInOutQuart' }
              }
          });

          // Â∑•Á®ãÈ°ûÂà•ÂúñË°®
          charts.category = new Chart(document.getElementById('categoryChart').getContext('2d'), {
              type: 'bar',
              data: { labels: [], datasets: [] },
              options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                      legend: { display: false }
                  },
                  scales: {
                      y: {
                          beginAtZero: true,
                          ticks: {
                              callback: function(value) {
                                  